\chapter[Klassische MCS am Beispiel des Ising Modells]{Klassische MCS\\\LARGE am Beispiel des Ising Modells}
\label{sec:Ising}

Um die Grundlagen der Monte-Carlo Simulation (MCS) kennenzulernen, betrachten wir zuerst die Simulation des klassischen, 2-dimensionalen Ising-Modells mit periodischer Randbedingung. Als Messgrößen wählen wir die typischen thermodynamischen Größen: Den Mittelwert der Energie, Wärmekapazität, Magnetisierung und Magnetische Suszeptibilität. Außerdem betrachten wir die Absolute Magnetisierung und Absolute, Magnetische Suszeptibilität, also den Mittelwert der absoluten Spin-Summe und dessen Varianz -- Die Begründung findet sich später. All diese Größen werden im Verhältnis zu einem Spin gemessen.

Im ersten Abschnitt knüpfen wir an das letzte Kapitel an, d.h. wir werden unsere Übergangswahrscheinlichkeiten $\boldsymbol{W}$ für dieses Szenario definieren. Der Abschnitt danach betrachtet die Struktur der erstellten Anwendung, also die Implementierung. Im letzten Abschnitt werden die Ergebnisse verschiedener Simulationen vorgestellt und diskutiert.

\section{Methode}

\subsection{Das Ising-Modell}

Für das klassische, ferromagnetische Ising-Modell ist der Hamiltonian

\begin{equation}
H_{\mathrm{Ising}}=-\sum_{\left\langle i,j\right\rangle}J_{ij}\cdot S_i^zS_j^z-h\sum_{i=0}^{N-1}\mu_{i}\cdot S_i^z
\label{eq:IsingHamiltonian}
\end{equation}

zusammengesetzt aus einer $z$-Koppelung benachbarter Spins $\left\langle i,j\right\rangle$, die durch die Bindungsmatrix $\boldsymbol{J}$ gewichtet wird, und einer magnetischen Wechselwirkung, in die das externe Magnetfeld $\boldsymbol{h}=(0,0,h)^T$ und das Magnetische Moment $\boldsymbol{\mu}=(0,0,\mu)^T$ eingeht. Für unser Beispiel setzten wir jedes $J_{ij}=1$ sowie $\mu_i=1$ und betrachten die Anordnung ohne Magnetfeld ($h=0$) -- da uns nur die $z$-Richtung interessiert, setzen wir $S=S^z\in\{-1;1\}$. Der Hamiltonian erhält dann die vereinfachte Struktur,

\begin{equation}
H=-\sum_{\left\langle i,j\right\rangle}S_iS_j\ \mathrm{.}
\label{eq:BeispielIsingHamiltonian}
\end{equation}

\subsection{Kanonische Übergangswahrscheinlichkeiten}
\label{sec:KanonischeUebergangswahrscheinlichkeiten}

Wegen der vorgegebenen Teilchenanzahl $N$ und Temperatur $T$ können wir für eine beliebige Größe $A$ den Mittelwert

\begin{equation}
\langle A\rangle =\sum_{\sigma\in\Omega}\frac{e^{-\beta E_\sigma}}{Z}\cdot A(\sigma )
\label{eq:KanonischerMittelwert}
\end{equation}

kanonisch ansetzen, wobei

\begin{equation}
Z=\sum_{\sigma\in\Omega}e^{-\beta E_\sigma}
\label{eq:Zustandssumme}
\end{equation}

die kanonische Zustandssumme, $\beta$ die reduzierte Temperatur $1/T$ (Wir setzten $k_B=1$) und $E_\sigma$ die Energie eines gewissen mikroskopischen Zustandes $\sigma$ (Konfiguration) darstellt. Im Vergleich zur Gl. \ref{eq:Mittelwert} sieht man, dass die Wahrscheinlichkeit eines Zustandes

\begin{equation}
p_\sigma=\frac{e^{-\beta E_\sigma}}{Z}
\label{eq:KanonischeWahrscheinlichkeit}
\end{equation}

boltzmannverteilt ist. Die Gewichte sind allerdings schwer zu berechnen. Da der Zustandsraum in solch einem Spin-System exponentiell mit der Spinanzahl anwächst ($\vert\Omega\vert\sim 2^N$), ist die genaue Berechnung von $Z$ für große Systeme nicht möglich. Machen wir allerdings vom Metropolis Algorithmus Gebrauch (siehe Gl. \ref{eq:Metropolis}), benötigen wir die einzelnen Gewichte gar nicht, sondern können uns mit deren Verhältnissen, die dann die Übergangswahrscheinlichkeiten $\boldsymbol{W}$ darstellen, genügen,

\begin{equation}
W_{\nu\sigma}=\begin{cases}
e^{-\beta(E_\sigma-E_\nu)} & E_\sigma>E_\nu\\
1                          & E_\sigma\leq E_\nu\ \mathrm{.}
\end{cases}
\label{eq:KanonischerMetropolis}
\end{equation}

\section{Implementierung}
\label{sec:KlassischeImplementierung}

Die Anwendung orientiert sich an \cite{Sandvik}. Sie gliedert sich grob in die Initialisierung des Systems, die Simulation des Modells sowie die Analyse der Messdaten. Um die gewünschten Größen abhängig von der Temperatur betrachten zu können, bietet es sich an, das Programm für mehrere Temperaturen durchzuführen.

\subsection{Initialisierung}

Generell müssen zuerst folgende Parameter festgelegt werden:

\begin{itemize}
\item Anzahl der Spins $N$,
\item Anzahl der Messungen $\widetilde{R}$ und
\item Temperatur des Systems $T$.
\end{itemize}

Für den Status der Spins legen wir ein $N$-langen Bitfeld and und initialisieren es mit zufälligen Daten. Da die sechs Größen, die gemessen werden sollen, sich von der Energie und der Spin-Summe 

\begin{equation}
S=\sum_{i=0}^{N-1}S_i
\label{eq:SpinSumme}
\end{equation}

ableiten lassen, speichern wir immer deren aktuelle Werte ab. Wie wir später sehen werden, können beide nach jedem MC-Schritt angepasst werden und müssen nicht jedes Mal erneut berechnet werden. Zu Beginn ist dies jedoch von nöten.

\subsection{Simulation}

Um den $R$-langen Markov Prozess auszuführen, verwenden wir eine Schleife, die jeweils einen MC-Schritt durchführt. Ab $\widehat{R}$ Durchläufen legen wir jedes Mal zusätzlich die aktuelle Energie, die Magnetisierung ($R=S/N$) und die Absolute Magnetisierung ($R=\vert S\vert/N$) in einem geeigneten Array ab.

\paragraph{Der Monte-Carlo Schritt} erzeugt ein neues Markov-Kettenglied, indem er versucht, jeden Spin des Systems umzudrehen (engl. flip). Das Umdrehen wird jeweils gestattet, wenn eine Zufallszahl zwischen 0 und 1 kleiner ist als das Boltzmanngewicht

\begin{equation}
e^{-\beta\Delta E}\ \mathrm{,}
\label{eq:Gewicht}
\end{equation}

wobei $\Delta E$ der Energieunterschied zwischen der neuen, möglichen Konfiguration und der aktuellen ist. Damit decken wir bereits die Gl. \ref{eq:KanonischerMetropolis} voll ab, da die Zufallszahl im zweiten Fall auf jeden Fall kleiner ist als das Boltzmanngewicht. Wird das Umdrehen eines Spins erlaubt, modifizieren wir das Spin-Array und addieren zur aktuellen Energie und Spin-Summe den berechneten Unterschied $\Delta E$ und $\Delta S$.

\paragraph{Die Berechnung der Energie- und Magnetisierungsunterschiede} erfordert allgemein, eine Neuberechnung der Größen. In unserem Fall kann dies jedoch abgekürzt werden:

\begin{itemize}
\item Zu $\Delta E$ tragen nur die Koppelungen zwischen dem Spin, den wir umdrehen wollen, und dessen Nachbaren bei. Diese sind im 2-dimensionalen Gitter die vier Spins über, unter sowie links und rechts von ihm.
\item $\Delta S$ ergibt sich einfach aus dem alten Status des Spins.
\end{itemize}

\subsection{Analyse}

Die Mittelwerte folgender Größen wollen wir berechnen (jeweils pro Spin):

\begin{align}\
\mathrm{Energie:}\quad & \left\langle\frac{E}{N}\right\rangle=\frac{-\partial_\beta\ln Z}{N}=\left\langle \frac{H}{N}\right\rangle\ \mathrm{,}\label{eq:Energie}\\[2mm]
\mathrm{W"arme Kapazit"at:}\quad & \left\langle\frac{C}{N}\right\rangle=\frac{\partial_T H}{N}=\frac{N}{T^2}\left(\left\langle\left(\frac{H}{N}\right)^2\right\rangle-\left\langle\frac{H}{N}\right\rangle^2\right)\ \mathrm{,}\label{eq:Waermekapazitaet}\\[2mm]
\mathrm{Magnetisierung:}\quad & \left\langle\frac{M}{N}\right\rangle=\frac{T\partial_B\ln Z}{N}=\left\langle\frac{S_i}{N}\right\rangle\ \mathrm{,}\label{eq:Magnetisierung}\\[2mm]
\mathrm{Magnetische\ Suszeptibilit"at:}\quad & \left\langle\frac{\chi}{N}\right\rangle=\frac{\partial_B M}{N}=\frac{N}{T}\left(\left\langle\left(\frac{S_i}{N}\right)^2\right\rangle-\left\langle\frac{S_i}{N}\right\rangle^2\right)\ \mathrm{,}\label{eq:Suszeptibilitaet}\\[2mm]
\mathrm{Abs.\ Magnetisierung:}\quad & \left\langle\frac{M'}{N}\right\rangle=\left\langle\left|\frac{S_i}{N}\right|\right\rangle\ \mathrm{,}\label{eq:AbsoluteMagnetisierung}\\[2mm]
\mathrm{Abs.,\ Mag.\ Suszeptibilit"at:}\quad & \left\langle\frac{\chi'}{N}\right\rangle=\frac{N}{T}\left(\left\langle\left|\frac{S_i}{N}\right|^2\right\rangle-\left\langle\left|\frac{S_i}{N}\right|\right\rangle^2\right)\ \mathrm{.}\label{eq:AbsoluteSuszeptibilitaet}
\end{align}

Für jede dieser Größen werden -- wie in Abschnitt \ref{sec:Autokorrelation} erklärt -- zuerst die Autokorrelationszeit berechnet und anschließend die Messdaten gruppiert sowie gemittelt.

\subsection{Quellcode}

Der vom Author geschriebene C++ Quellcode für diese Simulation ist im Anhang \ref{sec:code} zu finden. Folgende Dateien sind hierfür relevant:

\begin{itemize}
\item\ref{code:SIM}: Hauptprogramm
\item\ref{code:AbstractLattice}: Definition eines abstrakten Gittermodells
\item\ref{code:Periodic2DLattice}: 2-dimensionales Gittermodell mit periodischen Randbedingungen
\item\ref{code:AbstractAlgorithm}: Definition eines abstrakten Algorithmus' zur Simulation
\item\ref{code:ISINGAlgorithm}: Ising Algorithmus
\item\ref{code:AbstractAnalyzer}: Definition eines abstrakten Analysemoduls
\item\ref{code:IsingEnergyAnalyzer}: Analysemodul für die Energie (Ising)
\item\ref{code:IsingHeatCapacityAnalyzer}: Analysemodul für die Wärmekapazität (Ising)
\item\ref{code:IsingMagnetisationAnalyzer}: Analysemodul für die Magnetisierung (Ising)
\item\ref{code:IsingSusceptibilityAnalyzer}: Analysemodul für die Magnetische Suszeptibilität (Ising)
\item\ref{code:IsingAbsoluteMagnetisationAnalyzer}: Analysemodul für die Absolute Magnetisierung (Ising)
\item\ref{code:IsingAbsoluteSusceptibilityAnalyzer}: Analysemodul für die Absolute, Magnetische Suszeptibilität (Ising)
\end{itemize}

\section{Ergebnisse und Diskussion}

Bei der Gegenüberstellung mehrer Systemgrößen wurde der Übersichtlichkeit wegen auf eine Angabe des Fehlers verzichtet. Für die Mittelwerte der Grundgrößen $E$, $M$ und $M'$ sind diese kleiner als graphisch darstellbar. Mittelwerte weiterführender Größen $C$, $\chi$ und $\chi'$ besitzen dagegen üblicherweise einen signifikanten Fehelr in der Nähe des Phasenübergangs, ansonsten gilt dasselbe wie bei den Grundgrößen.

\subsection{Mittelwert der Energie und Wärmekapazität}

\begin{figure}[bh]
  \centering
  \subfloat[{\bfseries Mittelwert der Energie -- Temperatur}]{
    \label{fig:KMCSEnergie}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/Energie-Temperatur} 
  }
  \subfloat[{\bfseries Mittelwert der Wärmekapazität -- Temperatur}]{
    \label{fig:KMCSWaermekapazitaet}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/Waermekapazitaet-Temperatur} 
  }
  \caption[Mittelwert der Energie und Wärmekapazität -- Temperatur]{Diagramme der Mittelwerte der Energie und Wärmekapazität für verschieden große Gitter mit periodischen Randbedingungen bei 10000 Messpunkten pro Temperaturpunkt}
  \label{fig:KMCSEnergieWaermekapazitaet}
\end{figure}

Der Mittelwert der Energie (Gl. \ref{eq:Energie}) in Abb. \ref{fig:KMCSEnergie} verläuft erwartungsgemäß von -2 nach 0. Für kleine Temperaturen stehen alle Spins in die gleiche Richtung, da die Wahrscheinlichkeit eines Flips (Gl. \ref{eq:Gewicht}) eines einzelnen Spins gegen alle anderen verschwindend gering ist. Weil in einem 2-dimensionalen Gitter mit periodischen Randbedingungen die Anzahl der Kopplungen $N_b=2N$, hat der Mittelwert hier den Wert -2. Je höher jedoch die Temperatur steigt, je geringer wird der Einfluss des Boltzmanngewichts und führt letztendlich zu einer Gleichverteilung der Spins, die für $T\rightarrow\infty$ $\left\langle E/N\right\rangle\rightarrow0$ liefert.

Am Mittelwert der Wärmekapazität nach Gl. \ref{eq:Waermekapazitaet} (Abb. \ref{fig:KMCSWaermekapazitaet}), also der Ableitung der mittleren Energie nach $T$, erkennt man deutlich den Phasenübergang, der sich durch den höchsten Wert für die Steigung der mittleren Energie erkenntlich macht. Da die Größe weiterhin die Varianz der Energie darstellt, erklährt sich der Verlauf ebenfalls aus der starken Reaktion der Energie auf geringste Temperaturänderungen.

Ein Vergleich verschiedener Systemgrößen zeigt eine Verschiebung des Peaks der mittleren Wärmekapazität als auch dessen Anwachsen. Verantwortlich hierfür ist die begrenzte Systemgröße. Um die reale Übergangstemperatur $T_c$ zu finden, ist ein polynominaler Fit über mehrere Systemgrößen hinweg von Nöten (Finite Size Scaling). Auch Verfahren zur Bestimmung der kritischen Exponenten verwenden diese Methode.

\subsection{Autokorrelationszeit der Energie}

Wie wir sehen, nimmt auch die Autokorrelationszeit der Energie $\tau_E$ (Abb. \ref{fig:KMCSAutokorrelationszeitEnergie}, Gl. \ref{eq:Autokorrelationszeit}) um den Phasenübergang herum stark zu. Das bedeutet, dass die Konfigurationen über mehrere MC-Schritte hinweg korrelieren bzw. statistisch abhängig sind. Begründet liegt dies in der Tatsache, dass die Korrelationslänge $\xi$, ein Maß für die Korrelation innerhalb des Systems, am Phasenübergang divergiert und die Propagation von Information durch das System viel Zeit benötigt. $\tau_E$ ist neben der Temperatur auch vom System insbesondere dessen Größe abhängig.

\begin{figure}
  \centering
  \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/AutokorrelationszeitEnergie-Temperatur} 
  \caption[Autokorrelationszeit der Energie -- Temperatur]{{\bfseries Autokorrelationszeit der Energie -- Temperatur} Diagramm für verschieden große Gitter mit periodischen Randbedingungen bei 10000 Messpunkten pro Temperaturpunkt}
  \label{fig:KMCSAutokorrelationszeitEnergie}
\end{figure}

\subsection{Mittelwert der Magnetisierung und Magnetischen Suszeptibilität}

\begin{figure}[b!]
  \centering
  \subfloat[{\bfseries Mittelwert der Magnetisierung -- Temperatur}]{
    \label{fig:KMCSMagnetisierung}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/Magnetisierung-Temperatur} 
  }
  \subfloat[{\bfseries Mittelwert der Mag. Suszeptibilität -- Temperatur}]{
    \label{fig:KMCSSuszeptibilitaet}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/MagnetischeSuszeptibilitaet-Temperatur} 
  }
  \caption[Mittlere Magnetisierung und Magnetische Suszeptibilität -- Temperatur]{Diagramme der Mittelwerte der Magnetisierung und Magnetischen Suszeptibilität für verschieden große Gitter mit periodischen Randbedingungen bei 10000 Messpunkten pro Temperaturpunkt}
  \label{fig:KMCSMagnetisierungUndSuszeptibilitaet}
\end{figure}

Die weiter oben angesprochene Gleichverteilung der Spins bei hohen Temperaturen, drückt sich zusätzlich in der mittleren Magnetisierung in Abb. \ref{fig:KMCSMagnetisierung} (Gl. \ref{eq:Magnetisierung}) aus. Verringert man von diesem Thermischen Chaos aus die Temperatur, so beginnen die Spins in der Nähe des kritischen Punktes, sich in eine Richtung auszurichten. Da hierbei keine der beiden Richtungen einen Vorzug erhält, wechselt der Mittelwert der Magnetisierung beliebig das Vorzeichen.

Hier zeigt sich die Simulation mit dem Metropolis Algorithmus (Gl. \ref{eq:KanonischerMetropolis}) fehlerbehaftet, da sich die positiven und negativen Beiträge aus Symetriegründen aufheben müssten. In dieser Phase bilden sich jedoch Cluster von gleich ausgerichteten Spins, die der Algorithmus nur von den Rändern her beginnen kann umzudrehen, denn das Flippen eine Spins in der Mitte eines solchen Clusters ist sehr unwahrscheinlich. Die Cluster bleiben also für längere Zeit bestehen und brechen die Symetrie der Verteilung -- es entsteht eine vermeintliche Magnetisierung. Für kleine Temperaturen sieht man sogar, dass sich das Vorzeichen garnicht mehr verändert und mit der Zeit alle Spins, die noch entgegen dem Cluster stehen, geflippt werden.

Ein Algorithmus, welcher diesem Sachverhalt Sorge trägt, ist z.B. der von Swendson/Wang (1987) und Wolff (1989) \cite{Diplom} erstmals vorgestellte Cluster-Algorithmus. Die Cluster werden analysiert, im Ganzen gewichtet und eventuell geflippt. Für kleine Temperaturen werden die Cluster also bei fast jedem MC-Schritt geflippt und die Mittelung ergiebt eine verschwindende Magnetisierung.

Die Magnetische Suszeptibilität (Abb. \ref{fig:KMCSSuszeptibilitaet}, Gl. \ref{eq:Suszeptibilitaet}) zeigt ein ähnliches Verhalten, wie die Wärmekapazität. Auch sie formt zum Phasenübergang hin einen einen Peak aus. In der Realität ist allerdings auch sie immer 0, falls es kein Magnetfeld gibt.

\subsection{Mittelwert der Abs. Magnetisierung und Mag. Suszeptibilität}

Nachdem die Magnetisierung zufällig das Vorzeichen wechselt und sich für Systeme ohne externes Magnetfeld wegmittelt, betrachtet man häufig nur die Absolute Magnetisierung (Abb. \ref{fig:KMCSAbsoluteMagnetisierung}) und deren Varianz (Abb. \ref{fig:KMCSAbsoluteSuszeptibilitaet}) aus Gl. \ref{eq:AbsoluteMagnetisierung} und \ref{eq:AbsoluteSuszeptibilitaet}. Beide Größen verdeutlichen gut, dass der Prozess vom Thermischen Chaos zur Ordnung hin (und dem ausbilden von Clustern) mit größerem System schneller von Statten geht. Da diese spin-inversions-invariant sind, stellen sie trotz Clustern reale Größen dar.

Die mittlere Absolute, Magnetische Suszeptibilität bietet sich neben der Wärmekapazität weiterhin an, $T_c$ und Kritische Exponenten zu finden.

\begin{figure}[bh]
  \centering
  \subfloat[{\bfseries Mittelwert der Abs. Magnetisierung -- Temperatur}]{
    \label{fig:KMCSAbsoluteMagnetisierung}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/AbsoluteMagnetisierung-Temperatur} 
  }
  \subfloat[{\bfseries Mittelwert der Abs., Mag. Suszeptibilität -- Temperatur}]{
    \label{fig:KMCSAbsoluteSuszeptibilitaet}
    \includegraphics[width=0.48\textwidth]{Diagramme/KMCS/AbsoluteMagnetischeSuszeptibilitaet-Temperatur} 
  }
  \caption[Mittlere Abs. Magnetisierung und Mag. Suszeptibilität -- Temperatur]{Diagramme Mittelwerte der der Absoluten Magnetisierung und Magnetischen Suszeptibilität für verschieden große Gitter mit periodischen Randbedingungen bei 10000 Messpunkten pro Temperaturpunkt}
  \label{fig:KMCSAbsoluteMagnetisierungUndSuszeptibilitaet}
\end{figure}

%TODO:
%            Exact               My              Mean field
%Tc          2.269185            2.26228
%ny          1                   1 (angenommen)  0.5
%gamma       1.75                1.75958         1
%beta        0.125               0.125           0.5